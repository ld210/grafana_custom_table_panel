define(["lodash","@grafana/ui","moment","app/core/utils/kbn"],function(t,e,l,r){return function(t){var e={};function l(r){if(e[r])return e[r].exports;var a=e[r]={i:r,l:!1,exports:{}};return t[r].call(a.exports,a,a.exports,l),a.l=!0,a.exports}return l.m=t,l.c=e,l.d=function(t,e,r){l.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},l.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},l.t=function(t,e){if(1&e&&(t=l(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(l.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)l.d(r,a,function(e){return t[e]}.bind(null,a));return r},l.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return l.d(e,"a",e),e},l.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},l.p="",l(l.s=6)}([function(e,l){e.exports=t},,function(t,l){t.exports=e},,,,function(t,e,l){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TableRenderer=void 0;var r=i(l(0)),a=i(l(7)),o=i(l(8)),n=l(2);function i(t){return t&&t.__esModule?t:{default:t}}var s=function(){function t(t,e,l,r,a,o){this.panel=t,this.table=e,this.isUtc=l,this.sanitize=r,this.templateSrv=a,this.theme=o,this.initColumns()}return t.prototype.setTable=function(t){this.table=t,this.initColumns()},t.prototype.initColumns=function(){this.formatters=[],this.colorState={};for(var t=0;t<this.table.columns.length;t++){var e=this.table.columns[t];e.title=e.text;for(var l=0;l<this.panel.styles.length;l++){var r=this.panel.styles[l],a=o.default.stringToJsRegex(r.pattern);if(e.text.match(a)){e.style=r,r.alias&&(e.title=e.text.replace(a,r.alias));break}}this.formatters[t]=this.createColumnFormatter(e)}},t.prototype.getColorForValue=function(t,e){if(!e.thresholds)return null;for(var l=e.thresholds.length;l>0;l--)if(t>=e.thresholds[l-1])return(0,n.getColorFromHexRgbOrName)(e.colors[l],this.theme);return(0,n.getColorFromHexRgbOrName)(e.colors[0],this.theme)},t.prototype.defaultCellFormatter=function(t,e){return null==t||void 0===t?"":(r.default.isArray(t)&&(t=t.join(", ")),e&&e.sanitize?this.sanitize(t):r.default.escape(t))},t.prototype.createColumnFormatter=function(t){var e=this;if(!t.style)return this.defaultCellFormatter;if("hidden"===t.style.type)return function(t){};if("date"===t.style.type)return function(l){if(null==l)return"-";r.default.isArray(l)&&(l=l[0]),r.default.isString(l)&&!isNaN(Number(l))&&l.length>12&&(l=parseInt(l,10));var o=(0,a.default)(l);return e.isUtc&&(o=o.utc()),t.style.rawValue=l,o.format(t.style.dateFormat)};if("string"===t.style.type)return function(l){r.default.isArray(l)&&(l=l.join(", "));var a=t.style.mappingType||0;if(1===a&&t.style.valueMaps)for(var o=0;o<t.style.valueMaps.length;o++){var n=t.style.valueMaps[o];if(null!==l){if(!r.default.isString(l)&&Number(n.value)===Number(l)||n.value===l)return e.setColorState(l,t.style),e.defaultCellFormatter(n.text,t.style)}else if("null"===n.value)return n.text}if(2===a&&t.style.rangeMaps)for(o=0;o<t.style.rangeMaps.length;o++)if(n=t.style.rangeMaps[o],null!==l){if(Number(n.from)<=Number(l)&&Number(n.to)>=Number(l))return e.setColorState(l,t.style),e.defaultCellFormatter(n.text,t.style)}else if("null"===n.from&&"null"===n.to)return n.text;return null==l?"-":(e.setColorState(l,t.style),e.defaultCellFormatter(l,t.style))};if("number"===t.style.type){var l=(0,n.getValueFormat)(t.unit||t.style.unit);return function(a){return t.style.rawValue=a,null==a?"-":r.default.isString(a)||r.default.isArray(a)?e.defaultCellFormatter(a,t.style):(e.setColorState(a,t.style),l(a,t.style.decimals,null))}}return function(l){return t.style.rawValue=l,e.defaultCellFormatter(l,t.style)}},t.prototype.setColorState=function(t,e){if(e.colorMode&&null!=t&&!r.default.isArray(t)){var l=Number(t);isNaN(l)||(this.colorState[e.colorMode]=this.getColorForValue(l,e))}},t.prototype.renderRowVariables=function(t){for(var e={},l=this.table.rows[t],r=0;r<l.length;r++)e["__cell_"+r]={value:l[r]};return e},t.prototype.formatColumnValue=function(t,e){return this.formatters[t]?this.formatters[t](e):e},t.prototype.renderCell=function(t,e,l,r){void 0===r&&(r=!1),l=this.formatColumnValue(t,l);var a=this.table.columns[t],o="",n="",i=[],s="";this.colorState.cell?(o=' style="background-color:'+this.colorState.cell+'"',i.push("table-panel-color-cell"),this.colorState.cell=null):this.colorState.value&&(n=' style="color:'+this.colorState.value+'"',this.colorState.value=null);var u="";if(r&&(u='<div class="table-panel-width-hack">'+this.table.columns[t].title+"</div>"),void 0===l?(o=' style="display:none;"',a.hidden=!0):a.hidden=!1,!0===a.hidden)return"";if(a.style&&a.style.preserveFormat&&i.push("table-panel-cell-pre"),a.style&&a.style.link){var f=this.renderRowVariables(e);f.__cell={value:l};var c=this.templateSrv.replace(a.style.linkUrl,f,encodeURIComponent),p=this.templateSrv.replace(a.style.linkTooltip,f),d=a.style.linkTargetBlank?"_blank":"";i.push("table-panel-cell-link"),u+='\n        <a href="'+c+'" target="'+d+'" data-link-tooltip data-original-title="'+p+'" data-placement="right"'+n+">\n          "+l+"\n        </a>\n      "}else u+=l;if(a.filterable&&(i.push("table-panel-cell-filterable"),u+='\n        <a class="table-panel-filter-link" data-link-tooltip data-original-title="Filter out value" data-placement="bottom"\n           data-row="'+e+'" data-column="'+t+'" data-operator="!=">\n          <i class="fa fa-search-minus"></i>\n        </a>\n        <a class="table-panel-filter-link" data-link-tooltip data-original-title="Filter for value" data-placement="bottom"\n           data-row="'+e+'" data-column="'+t+'" data-operator="=">\n          <i class="fa fa-search-plus"></i>\n        </a>'),i.length&&(s=' class="'+i.join(" ")+'"'),a.style&&"delta"===a.style.type){var h=Number(a.style.rawValue),y=h>0?"up":h<0?"down":void 0,m=a.style.colors,b="up"===y?m[m.length-1]:"down"===y?m[0]:"#ffffff";u=y?'\n        <div class="arrow-container" style="display:block;width:25px;height:25px;color:'+b+';font-size:20px;line-height:25px;">\n          <i class="grafana-tip fa fa-arrow-'+y+'" bs-tooltip="'+l+'" data-original-title title="'+l+'"></i>\n          <span class="bidder-tooltip">'+l+"</span>\n        </div>\n      ":"-"}return u=a.style&&"progressbar"===a.style.display?'\n      <td style="padding:0;background-color:#212124;">\n        <div style="display:block;width:'+l+";max-width:100%;height:100%;padding:5px 0;background-color:"+(b=this.getColorForValue(Number(a.style.rawValue),a.style))+'">'+l+"</div>\n      </td>":"<td"+s+o+n+">"+u+"</td>"},t.prototype.render=function(t){for(var e=this.panel.pageSize||100,l=t*e,r=Math.min(l+e,this.table.rows.length),a="",o=[],n="",i=l;i<r;i++){for(var s=this.table.rows[i],u="",f="",c=0;c<this.table.columns.length;c++)u+=this.renderCell(c,i,s[c],i===l);this.colorState.row&&(f=' style="background-color:'+this.colorState.row+'"',o.push("table-panel-color-row"),this.colorState.row=null),o.length&&(n=' class="'+o.join(" ")+'"'),a+="<tr "+n+f+">"+u+"</tr>"}return a},t.prototype.render_values=function(){for(var t=[],e=0;e<this.table.rows.length;e++){for(var l=this.table.rows[e],r=[],a=0;a<this.table.columns.length;a++)r.push(this.formatColumnValue(a,l[a]));t.push(r)}return{columns:this.table.columns,rows:t}},t}();e.TableRenderer=s},function(t,e){t.exports=l},function(t,e){t.exports=r}])});
//# sourceMappingURL=renderer.js.map