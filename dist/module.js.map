{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./column_options.ts","webpack:///./editor.ts","webpack:///./module.ts","webpack:///./renderer.ts","webpack:///./transformers.ts","webpack:///external \"@grafana/ui\"","webpack:///external \"app/core/config\"","webpack:///external \"app/core/table_model\"","webpack:///external \"app/core/time_series2\"","webpack:///external \"app/core/utils/flatten\"","webpack:///external \"app/core/utils/kbn\"","webpack:///external \"app/plugins/sdk\"","webpack:///external \"jquery\"","webpack:///external \"lodash\"","webpack:///external \"moment\""],"names":[],"mappings":"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","file":"module.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./module.ts\");\n","import _ from 'lodash';\nimport { getValueFormats } from '@grafana/ui';\n\nexport class ColumnOptionsCtrl {\n  panel: any;\n  panelCtrl: any;\n  colorModes: any;\n  columnStyles: any;\n  columnTypes: any;\n  displayOptions: any;\n  countryDisplayOptions: any;\n  fontSizes: any;\n  dateFormats: any;\n  addColumnSegment: any;\n  unitFormats: any;\n  getColumnNames: any;\n  activeStyleIndex: number;\n  mappingTypes: any;\n\n  /** @ngInject */\n  constructor($scope) {\n    $scope.editor = this;\n\n    this.activeStyleIndex = 0;\n    this.panelCtrl = $scope.ctrl;\n    this.panel = this.panelCtrl.panel;\n    this.unitFormats = getValueFormats();\n    this.colorModes = [\n      { text: 'Disabled', value: null },\n      { text: 'Cell', value: 'cell' },\n      { text: 'Value', value: 'value' },\n      { text: 'Row', value: 'row' },\n    ];\n    this.columnTypes = [\n      { text: 'Number', value: 'number' },\n      { text: 'String', value: 'string' },\n      { text: 'Country code', value: 'flags'},\n      { text: 'Date', value: 'date' },\n      { text: 'Hidden', value: 'hidden' },\n    ];\n    this.displayOptions = [\n      { text: 'Value', value: 'val' },\n      { text: 'Progress Bar', value: 'progressbar' },\n      { text: 'Delta', value: 'delta' }\n    ];\n    this.countryDisplayOptions = [\n      { text: 'ISO Code', value: 'iso' },\n      { text: 'Flag icon', value: 'flagicon' }\n    ];\n    this.fontSizes = ['80%', '90%', '100%', '110%', '120%', '130%', '150%', '160%', '180%', '200%', '220%', '250%'];\n    this.dateFormats = [\n      { text: 'YYYY-MM-DD HH:mm:ss', value: 'YYYY-MM-DD HH:mm:ss' },\n      { text: 'YYYY-MM-DD HH:mm:ss.SSS', value: 'YYYY-MM-DD HH:mm:ss.SSS' },\n      { text: 'MM/DD/YY h:mm:ss a', value: 'MM/DD/YY h:mm:ss a' },\n      { text: 'MMMM D, YYYY LT', value: 'MMMM D, YYYY LT' },\n      { text: 'YYYY-MM-DD', value: 'YYYY-MM-DD' },\n    ];\n    this.mappingTypes = [{ text: 'Value to text', value: 1 }, { text: 'Range to text', value: 2 }];\n\n    this.getColumnNames = () => {\n      if (!this.panelCtrl.table) {\n        return [];\n      }\n      return _.map(this.panelCtrl.table.columns, (col: any) => {\n        return col.text;\n      });\n    };\n\n    this.onColorChange = this.onColorChange.bind(this);\n  }\n\n  render() {\n    this.panelCtrl.render();\n  }\n\n  setUnitFormat(column, subItem) {\n    column.unit = subItem.value;\n    this.panelCtrl.render();\n  }\n\n  addColumnStyle() {\n    const newStyleRule = {\n      unit: 'short',\n      type: 'number',\n      alias: '',\n      decimals: 2,\n      colors: ['rgba(245, 54, 54, 0.9)', 'rgba(237, 129, 40, 0.89)', 'rgba(50, 172, 45, 0.97)'],\n      colorMode: null,\n      pattern: '',\n      dateFormat: 'YYYY-MM-DD HH:mm:ss',\n      thresholds: [],\n      mappingType: 1,\n      display: 'val'\n    };\n\n    const styles = this.panel.styles;\n    const stylesCount = styles.length;\n    let indexToInsert = stylesCount;\n\n    // check if last is a catch all rule, then add it before that one\n    if (stylesCount > 0) {\n      const last = styles[stylesCount - 1];\n      if (last.pattern === '/.*/') {\n        indexToInsert = stylesCount - 1;\n      }\n    }\n\n    styles.splice(indexToInsert, 0, newStyleRule);\n    this.activeStyleIndex = indexToInsert;\n  }\n\n  removeColumnStyle(style) {\n    this.panel.styles = _.without(this.panel.styles, style);\n  }\n\n  invertColorOrder(index) {\n    const ref = this.panel.styles[index].colors;\n    const copy = ref[0];\n    ref[0] = ref[2];\n    ref[2] = copy;\n    this.panelCtrl.render();\n  }\n\n  onColorChange(styleIndex, colorIndex) {\n    return newColor => {\n      this.panel.styles[styleIndex].colors[colorIndex] = newColor;\n      this.render();\n    };\n  }\n\n  addValueMap(style) {\n    if (!style.valueMaps) {\n      style.valueMaps = [];\n    }\n    style.valueMaps.push({ value: '', text: '' });\n    this.panelCtrl.render();\n  }\n\n  removeValueMap(style, index) {\n    style.valueMaps.splice(index, 1);\n    this.panelCtrl.render();\n  }\n\n  addRangeMap(style) {\n    if (!style.rangeMaps) {\n      style.rangeMaps = [];\n    }\n    style.rangeMaps.push({ from: '', to: '', text: '' });\n    this.panelCtrl.render();\n  }\n\n  removeRangeMap(style, index) {\n    style.rangeMaps.splice(index, 1);\n    this.panelCtrl.render();\n  }\n}\n\n/** @ngInject */\nexport function columnOptionsTab($q, uiSegmentSrv) {\n  'use strict';\n  return {\n    restrict: 'E',\n    scope: true,\n    templateUrl: 'public/plugins/tradelab-bidder-table/column_options.html',\n    controller: ColumnOptionsCtrl,\n  };\n}\n","import _ from 'lodash';\nimport { transformers } from './transformers';\n\nexport class TablePanelEditorCtrl {\n  panel: any;\n  panelCtrl: any;\n  transformers: any;\n  fontSizes: any;\n  addColumnSegment: any;\n  getColumnNames: any;\n  canSetColumns: boolean;\n  columnsHelpMessage: string;\n\n  /** @ngInject */\n  constructor($scope, private $q, private uiSegmentSrv) {\n    $scope.editor = this;\n    this.panelCtrl = $scope.ctrl;\n    this.panel = this.panelCtrl.panel;\n    this.transformers = transformers;\n    this.fontSizes = ['80%', '90%', '100%', '110%', '120%', '130%', '150%', '160%', '180%', '200%', '220%', '250%'];\n    this.addColumnSegment = uiSegmentSrv.newPlusButton();\n    this.updateTransformHints();\n  }\n\n  updateTransformHints() {\n    this.canSetColumns = false;\n    this.columnsHelpMessage = '';\n\n    switch (this.panel.transform) {\n      case 'timeseries_aggregations': {\n        this.canSetColumns = true;\n        break;\n      }\n      case 'json': {\n        this.canSetColumns = true;\n        break;\n      }\n      case 'table': {\n        this.columnsHelpMessage = 'Columns and their order are determined by the data query';\n      }\n    }\n  }\n\n  getColumnOptions() {\n    if (!this.panelCtrl.dataRaw) {\n      return this.$q.when([]);\n    }\n    const columns = this.transformers[this.panel.transform].getColumns(this.panelCtrl.dataRaw);\n    const segments = _.map(columns, (c: any) => this.uiSegmentSrv.newSegment({ value: c.text }));\n    return this.$q.when(segments);\n  }\n\n  addColumn() {\n    const columns = transformers[this.panel.transform].getColumns(this.panelCtrl.dataRaw);\n    const column = _.find(columns, { text: this.addColumnSegment.value });\n\n    if (column) {\n      this.panel.columns.push(column);\n      this.render();\n    }\n\n    const plusButton = this.uiSegmentSrv.newPlusButton();\n    this.addColumnSegment.html = plusButton.html;\n    this.addColumnSegment.value = plusButton.value;\n  }\n\n  transformChanged() {\n    this.panel.columns = [];\n    if (this.panel.transform === 'timeseries_aggregations') {\n      this.panel.columns.push({ text: 'Avg', value: 'avg' });\n    }\n\n    this.updateTransformHints();\n    this.render();\n  }\n\n  render() {\n    this.panelCtrl.render();\n  }\n\n  removeColumn(column) {\n    this.panel.columns = _.without(this.panel.columns, column);\n    this.panelCtrl.render();\n  }\n}\n\n/** @ngInject */\nexport function tablePanelEditor($q, uiSegmentSrv) {\n  'use strict';\n  return {\n    restrict: 'E',\n    scope: true,\n    templateUrl: 'public/plugins/tradelab-bidder-table/editor.html',\n    controller: TablePanelEditorCtrl,\n  };\n}\n","import _ from 'lodash';\nimport $ from 'jquery';\nimport { MetricsPanelCtrl, loadPluginCss } from 'grafana/app/plugins/sdk';\nimport config from 'grafana/app/core/config';\nimport { transformDataToTable } from './transformers';\nimport { tablePanelEditor } from './editor';\nimport { columnOptionsTab } from './column_options';\nimport { TableRenderer } from './renderer';\n\nclass TablePanelCtrl extends MetricsPanelCtrl {\n  static templateUrl = 'module.html';\n\n  pageIndex: number;\n  dataRaw: any;\n  table: any;\n  renderer: any;\n\n  panelDefaults = {\n    targets: [{}],\n    transform: 'timeseries_to_columns',\n    pageSize: null,\n    showHeader: true,\n    styles: [\n      {\n        type: 'date',\n        pattern: 'Time',\n        alias: 'Time',\n        dateFormat: 'YYYY-MM-DD HH:mm:ss',\n      },\n      {\n        unit: 'short',\n        type: 'number',\n        alias: '',\n        decimals: 2,\n        colors: ['rgba(245, 54, 54, 0.9)', 'rgba(237, 129, 40, 0.89)', 'rgba(50, 172, 45, 0.97)'],\n        colorMode: null,\n        pattern: '/.*/',\n        thresholds: [],\n      },\n    ],\n    columns: [],\n    scroll: true,\n    fontSize: '100%',\n    sort: { col: 0, desc: true },\n  };\n\n  /** @ngInject */\n  constructor($scope, $injector, templateSrv, private annotationsSrv, private $sanitize, private variableSrv) {\n    super($scope, $injector);\n\n    this.pageIndex = 0;\n\n    if (this.panel.styles === void 0) {\n      this.panel.styles = this.panel.columns;\n      this.panel.columns = this.panel.fields;\n      delete this.panel.columns;\n      delete this.panel.fields;\n    }\n\n    _.defaults(this.panel, this.panelDefaults);\n\n    this.events.on('data-received', this.onDataReceived.bind(this));\n    this.events.on('data-error', this.onDataError.bind(this));\n    this.events.on('data-snapshot-load', this.onDataReceived.bind(this));\n    this.events.on('init-edit-mode', this.onInitEditMode.bind(this));\n    this.events.on('init-panel-actions', this.onInitPanelActions.bind(this));\n  }\n\n  onInitEditMode() {\n    this.addEditorTab('Options', tablePanelEditor, 2);\n    this.addEditorTab('Column Styles', columnOptionsTab, 3);\n  }\n\n  onInitPanelActions(actions) {\n    actions.push({ text: 'Export CSV', click: 'ctrl.exportCsv()' });\n  }\n\n  issueQueries(datasource) {\n    this.pageIndex = 0;\n\n    if (this.panel.transform === 'annotations') {\n      return this.annotationsSrv\n        .getAnnotations({\n          dashboard: this.dashboard,\n          panel: this.panel,\n          range: this.range,\n        })\n        .then(annotations => {\n          return { data: annotations };\n        });\n    }\n\n    return super.issueQueries(datasource);\n  }\n\n  onDataError(err) {\n    this.dataRaw = [];\n    this.render();\n  }\n\n  onDataReceived(dataList) {\n    this.dataRaw = dataList;\n    this.pageIndex = 0;\n\n    // automatically correct transform mode based on data\n    if (this.dataRaw && this.dataRaw.length) {\n      if (this.dataRaw[0].type === 'table') {\n        this.panel.transform = 'table';\n      } else {\n        if (this.dataRaw[0].type === 'docs') {\n          this.panel.transform = 'json';\n        } else {\n          if (this.panel.transform === 'table' || this.panel.transform === 'json') {\n            this.panel.transform = 'timeseries_to_rows';\n          }\n        }\n      }\n    }\n\n    this.render();\n  }\n\n  render() {\n    this.table = transformDataToTable(this.dataRaw, this.panel);\n    this.table.sort(this.panel.sort);\n\n    this.renderer = new TableRenderer(\n      this.panel,\n      this.table,\n      this.dashboard.isTimezoneUtc(),\n      this.$sanitize,\n      this.templateSrv,\n      config.theme.type\n    );\n\n    return super.render(this.table);\n  }\n\n  toggleColumnSort(col, colIndex) {\n    // remove sort flag from current column\n    if (this.table.columns[this.panel.sort.col]) {\n      this.table.columns[this.panel.sort.col].sort = false;\n    }\n\n    if (this.panel.sort.col === colIndex) {\n      if (this.panel.sort.desc) {\n        this.panel.sort.desc = false;\n      } else {\n        this.panel.sort.col = null;\n      }\n    } else {\n      this.panel.sort.col = colIndex;\n      this.panel.sort.desc = true;\n    }\n    this.render();\n  }\n\n  exportCsv() {\n    const scope = this.$scope.$new(true);\n    scope.tableData = this.renderer.render_values();\n    scope.panel = 'table';\n    this.publishAppEvent('show-modal', {\n      templateHtml: '<export-data-modal panel=\"panel\" data=\"tableData\"></export-data-modal>',\n      scope,\n      modalClass: 'modal--narrow',\n    });\n  }\n\n  link(scope, elem, attrs, ctrl: TablePanelCtrl) {\n    let data;\n    const panel = ctrl.panel;\n    let pageCount = 0;\n\n    function getTableHeight() {\n      let panelHeight = ctrl.height;\n\n      if (pageCount > 1) {\n        panelHeight -= 26;\n      }\n\n      return panelHeight - 31 + 'px';\n    }\n\n    function appendTableRows(tbodyElem) {\n      ctrl.renderer.setTable(data);\n      tbodyElem.empty();\n      tbodyElem.html(ctrl.renderer.render(ctrl.pageIndex));\n    }\n\n    function switchPage(e) {\n      const el = $(e.currentTarget);\n      ctrl.pageIndex = parseInt(el.text(), 10) - 1;\n      renderPanel();\n    }\n\n    function appendPaginationControls(footerElem) {\n      footerElem.empty();\n\n      const pageSize = panel.pageSize || 100;\n      pageCount = Math.ceil(data.rows.length / pageSize);\n      if (pageCount === 1) {\n        return;\n      }\n\n      const startPage = Math.max(ctrl.pageIndex - 3, 0);\n      const endPage = Math.min(pageCount, startPage + 9);\n\n      const paginationList = $('<ul></ul>');\n\n      for (let i = startPage; i < endPage; i++) {\n        const activeClass = i === ctrl.pageIndex ? 'active' : '';\n        const pageLinkElem = $(\n          '<li><a class=\"table-panel-page-link pointer ' + activeClass + '\">' + (i + 1) + '</a></li>'\n        );\n        paginationList.append(pageLinkElem);\n      }\n\n      footerElem.append(paginationList);\n    }\n\n    function renderPanel() {\n      const panelElem = elem.parents('.panel-content');\n      const rootElem = elem.find('.table-panel-scroll');\n      const tbodyElem = elem.find('tbody');\n      const footerElem = elem.find('.table-panel-footer');\n\n      elem.css({ 'font-size': panel.fontSize });\n      panelElem.addClass('table-panel-content');\n\n      appendTableRows(tbodyElem);\n      appendPaginationControls(footerElem);\n\n      rootElem.css({ 'max-height': panel.scroll ? getTableHeight() : '' });\n    }\n\n    // hook up link tooltips\n    elem.tooltip({\n      selector: '[data-link-tooltip]',\n    });\n\n    function addFilterClicked(e) {\n      const filterData = $(e.currentTarget).data();\n      const options = {\n        datasource: panel.datasource,\n        key: data.columns[filterData.column].text,\n        value: data.rows[filterData.row][filterData.column],\n        operator: filterData.operator,\n      };\n\n      ctrl.variableSrv.setAdhocFilter(options);\n    }\n\n    elem.on('click', '.table-panel-page-link', switchPage);\n    elem.on('click', '.table-panel-filter-link', addFilterClicked);\n\n    const unbindDestroy = scope.$on('$destroy', () => {\n      elem.off('click', '.table-panel-page-link');\n      elem.off('click', '.table-panel-filter-link');\n      unbindDestroy();\n    });\n\n    ctrl.events.on('render', renderData => {\n      data = renderData || data;\n      if (data) {\n        renderPanel();\n      }\n      ctrl.renderingCompleted();\n    });\n  }\n}\nloadPluginCss({\n  dark: 'plugins/tradelab-bidder-table/styles/dark-bidder-panel.css',\n  light: 'plugins/tradelab-bidder-table/styles/light-bidder-panel.css'\n});\nexport { TablePanelCtrl, TablePanelCtrl as PanelCtrl };\n","import _ from 'lodash';\nimport moment from 'moment';\nimport kbn from 'grafana/app/core/utils/kbn';\nimport { getValueFormat, getColorFromHexRgbOrName, GrafanaThemeType } from '@grafana/ui';\n\nexport class TableRenderer {\n  formatters: any[];\n  colorState: any;\n\n  constructor(\n    private panel,\n    private table,\n    private isUtc,\n    private sanitize,\n    private templateSrv,\n    private theme?: GrafanaThemeType\n  ) {\n    this.initColumns();\n  }\n\n  setTable(table) {\n    this.table = table;\n\n    this.initColumns();\n  }\n\n  initColumns() {\n    this.formatters = [];\n    this.colorState = {};\n\n    for (let colIndex = 0; colIndex < this.table.columns.length; colIndex++) {\n      const column = this.table.columns[colIndex];\n      column.title = column.text;\n\n      for (let i = 0; i < this.panel.styles.length; i++) {\n        const style = this.panel.styles[i];\n\n        const regex = kbn.stringToJsRegex(style.pattern);\n        if (column.text.match(regex)) {\n          column.style = style;\n\n          if (style.alias) {\n            column.title = column.text.replace(regex, style.alias);\n          }\n\n          break;\n        }\n      }\n\n      this.formatters[colIndex] = this.createColumnFormatter(column);\n    }\n  }\n\n  getColorForValue(value, style) {\n    if (!style.thresholds) {\n      return null;\n    }\n    for (let i = style.thresholds.length; i > 0; i--) {\n      if (value >= style.thresholds[i - 1]) {\n        return getColorFromHexRgbOrName(style.colors[i], this.theme);\n      }\n    }\n    return getColorFromHexRgbOrName(style.colors[0], this.theme);\n  }\n\n  defaultCellFormatter(v, style) {\n    if (v === null || v === void 0 || v === undefined) {\n      return '';\n    }\n\n    if (_.isArray(v)) {\n      v = v.join(', ');\n    }\n\n    if (style && style.sanitize) {\n      return this.sanitize(v);\n    } else {\n      return _.escape(v);\n    }\n  }\n\n  createColumnFormatter(column) {\n    if (!column.style) {\n      return this.defaultCellFormatter;\n    }\n\n    if (column.style.type === 'hidden') {\n      return v => {\n        return undefined;\n      };\n    }\n\n    if (column.style.type === 'date') {\n      return v => {\n        if (v === undefined || v === null) {\n          return '-';\n        }\n\n        if (_.isArray(v)) {\n          v = v[0];\n        }\n\n        // if is an epoch (numeric string and len > 12)\n        if (_.isString(v) && !isNaN(Number(v)) && v.length > 12) {\n          v = parseInt(v, 10);\n        }\n\n        let date = moment(v);\n\n        if (this.isUtc) {\n          date = date.utc();\n        }\n        column.style.rawValue = v;\n        return date.format(column.style.dateFormat);\n      };\n    }\n\n    if (column.style.type === 'string') {\n      return v => {\n        if (_.isArray(v)) {\n          v = v.join(', ');\n        }\n\n        const mappingType = column.style.mappingType || 0;\n\n        if (mappingType === 1 && column.style.valueMaps) {\n          for (let i = 0; i < column.style.valueMaps.length; i++) {\n            const map = column.style.valueMaps[i];\n\n            if (v === null) {\n              if (map.value === 'null') {\n                return map.text;\n              }\n              continue;\n            }\n\n            // Allow both numeric and string values to be mapped\n            if ((!_.isString(v) && Number(map.value) === Number(v)) || map.value === v) {\n              this.setColorState(v, column.style);\n              return this.defaultCellFormatter(map.text, column.style);\n            }\n          }\n        }\n\n        if (mappingType === 2 && column.style.rangeMaps) {\n          for (let i = 0; i < column.style.rangeMaps.length; i++) {\n            const map = column.style.rangeMaps[i];\n\n            if (v === null) {\n              if (map.from === 'null' && map.to === 'null') {\n                return map.text;\n              }\n              continue;\n            }\n\n            if (Number(map.from) <= Number(v) && Number(map.to) >= Number(v)) {\n              this.setColorState(v, column.style);\n              return this.defaultCellFormatter(map.text, column.style);\n            }\n          }\n        }\n\n        if (v === null || v === void 0) {\n          return '-';\n        }\n\n        this.setColorState(v, column.style);\n        return this.defaultCellFormatter(v, column.style);\n      };\n    }\n\n    if (column.style.type === 'number') {\n      const valueFormatter = getValueFormat(column.unit || column.style.unit);\n\n      return v => {\n        column.style.rawValue = v;\n        if (v === null || v === void 0) {\n          return '-';\n        }\n\n        if (_.isString(v) || _.isArray(v)) {\n          return this.defaultCellFormatter(v, column.style);\n        }\n\n        this.setColorState(v, column.style);\n        return valueFormatter(v, column.style.decimals, null);\n      };\n    }\n\n    return value => {\n      column.style.rawValue = value;\n      return this.defaultCellFormatter(value, column.style);\n    };\n  }\n\n  setColorState(value, style) {\n    if (!style.colorMode) {\n      return;\n    }\n\n    if (value === null || value === void 0 || _.isArray(value)) {\n      return;\n    }\n\n    const numericValue = Number(value);\n    if (isNaN(numericValue)) {\n      return;\n    }\n\n    this.colorState[style.colorMode] = this.getColorForValue(numericValue, style);\n  }\n\n  renderRowVariables(rowIndex) {\n    const scopedVars = {};\n    let cellVariable;\n    const row = this.table.rows[rowIndex];\n    for (let i = 0; i < row.length; i++) {\n      cellVariable = `__cell_${i}`;\n      scopedVars[cellVariable] = { value: row[i] };\n    }\n    return scopedVars;\n  }\n\n  formatColumnValue(colIndex, value) {\n    return this.formatters[colIndex] ? this.formatters[colIndex](value) : value;\n  }\n\n  renderCell(columnIndex, rowIndex, value, addWidthHack = false) {\n    value = this.formatColumnValue(columnIndex, value);\n\n    const column = this.table.columns[columnIndex];\n    let cellStyle = '';\n    let textStyle = '';\n    const cellClasses: any[] = [];\n    let cellClass = '';\n\n    if (this.colorState.cell) {\n      cellStyle = ' style=\"background-color:' + this.colorState.cell + '\"';\n      cellClasses.push('table-panel-color-cell');\n      this.colorState.cell = null;\n    } else if (this.colorState.value) {\n      textStyle = ' style=\"color:' + this.colorState.value + '\"';\n      this.colorState.value = null;\n    }\n    // because of the fixed table headers css only solution\n    // there is an issue if header cell is wider the cell\n    // this hack adds header content to cell (not visible)\n    let columnHtml = '';\n    if (addWidthHack) {\n      columnHtml = '<div class=\"table-panel-width-hack\">' + this.table.columns[columnIndex].title + '</div>';\n    }\n\n    if (value === undefined) {\n      cellStyle = ' style=\"display:none;\"';\n      column.hidden = true;\n    } else {\n      column.hidden = false;\n    }\n\n    if (column.hidden === true) {\n      return '';\n    }\n\n    if (column.style && column.style.preserveFormat) {\n      cellClasses.push('table-panel-cell-pre');\n    }\n\n    if (column.style && column.style.link) {\n      // Render cell as link\n      const scopedVars = this.renderRowVariables(rowIndex);\n      scopedVars['__cell'] = { value: value };\n\n      const cellLink = this.templateSrv.replace(column.style.linkUrl, scopedVars, encodeURIComponent);\n      const cellLinkTooltip = this.templateSrv.replace(column.style.linkTooltip, scopedVars);\n      const cellTarget = column.style.linkTargetBlank ? '_blank' : '';\n\n      cellClasses.push('table-panel-cell-link');\n\n      columnHtml += `\n        <a href=\"${cellLink}\" target=\"${cellTarget}\" data-link-tooltip data-original-title=\"${cellLinkTooltip}\" data-placement=\"right\"${textStyle}>\n          ${value}\n        </a>\n      `;\n    } else {\n      columnHtml += value;\n    }\n\n    if (column.filterable) {\n      cellClasses.push('table-panel-cell-filterable');\n      columnHtml += `\n        <a class=\"table-panel-filter-link\" data-link-tooltip data-original-title=\"Filter out value\" data-placement=\"bottom\"\n           data-row=\"${rowIndex}\" data-column=\"${columnIndex}\" data-operator=\"!=\">\n          <i class=\"fa fa-search-minus\"></i>\n        </a>\n        <a class=\"table-panel-filter-link\" data-link-tooltip data-original-title=\"Filter for value\" data-placement=\"bottom\"\n           data-row=\"${rowIndex}\" data-column=\"${columnIndex}\" data-operator=\"=\">\n          <i class=\"fa fa-search-plus\"></i>\n        </a>`;\n    }\n\n    if (cellClasses.length) {\n      cellClass = ' class=\"' + cellClasses.join(' ') + '\"';\n    }\n\n    if (column.style && column.style.type === 'flags') {\n      const code = column.style.rawValue.toLowerCase();\n      columnHtml = column.style.display === 'flagicon' ? `<span class=\"flag-icon flag-icon-${code}\"></span>` : value;\n    }\n\n    if (column.style && column.style.display === 'delta') {\n      const num = Number(column.style.rawValue);\n      const icon = num > 0 ? 'up' : num < 0 ? 'down' : undefined;\n      const colors = column.style.colors;\n      const color = icon === 'up' ? colors[colors.length - 1] : icon === 'down' ? colors[0] : '#ffffff';\n\n      const html = `\n        <div class=\"arrow-container\" style=\"display:block;width:25px;height:25px;color:${color};font-size:20px;line-height:25px;\">\n          <i class=\"grafana-tip fa fa-arrow-${icon}\"></i>\n          <span class=\"bidder-tooltip\">${value}</span>\n        </div>\n      `;\n\n      columnHtml = icon ? html : '-';\n    }\n\n    if (column.style && column.style.display === 'progressbar') {\n      const color = this.getColorForValue(Number(column.style.rawValue), column.style);\n      const pbarStyle = `display:block;width:${value};max-width:100%;height:100%;padding:5px 0;background-color:${color}`;\n\n      columnHtml = `\n      <td style=\"padding:0;background-color:#212124;\">\n        <div style=\"${pbarStyle}\"><span style=\"padding-left:15px;\">${value}</span></div>\n      </td>`;\n    } else {\n      columnHtml = '<td' + cellClass + cellStyle + textStyle + '>' + columnHtml + '</td>';\n    }\n    return columnHtml;\n  }\n\n  render(page) {\n    const pageSize = this.panel.pageSize || 100;\n    const startPos = page * pageSize;\n    const endPos = Math.min(startPos + pageSize, this.table.rows.length);\n    let html = '';\n    const rowClasses: any[] = [];\n    let rowClass = '';\n\n    for (let y = startPos; y < endPos; y++) {\n      const row = this.table.rows[y];\n      let cellHtml = '';\n      let rowStyle = '';\n      for (let i = 0; i < this.table.columns.length; i++) {\n        cellHtml += this.renderCell(i, y, row[i], y === startPos);\n      }\n\n      if (this.colorState.row) {\n        rowStyle = ' style=\"background-color:' + this.colorState.row + '\"';\n        rowClasses.push('table-panel-color-row');\n        this.colorState.row = null;\n      }\n\n      if (rowClasses.length) {\n        rowClass = ' class=\"' + rowClasses.join(' ') + '\"';\n      }\n\n      html += '<tr ' + rowClass + rowStyle + '>' + cellHtml + '</tr>';\n    }\n\n    return html;\n  }\n\n  render_values() {\n    const rows: any[] = [];\n\n    for (let y = 0; y < this.table.rows.length; y++) {\n      const row = this.table.rows[y];\n      const newRow: any[] = [];\n      for (let i = 0; i < this.table.columns.length; i++) {\n        newRow.push(this.formatColumnValue(i, row[i]));\n      }\n      rows.push(newRow);\n    }\n    return {\n      columns: this.table.columns,\n      rows: rows,\n    };\n  }\n}\n","import _ from 'lodash';\nimport flatten from 'grafana/app/core/utils/flatten';\nimport TimeSeries from 'grafana/app/core/time_series2';\nimport TableModel from 'grafana/app/core/table_model';\n\nconst transformers = {};\n\n// Returns true if both rows have matching non-empty fields as well as matching\n// indexes where one field is empty and the other is not\nfunction areRowsMatching(columns, row, otherRow) {\n  let foundFieldToMatch = false;\n  for (let columnIndex = 0; columnIndex < columns.length; columnIndex++) {\n    if (row[columnIndex] !== undefined && otherRow[columnIndex] !== undefined) {\n      if (row[columnIndex] !== otherRow[columnIndex]) {\n        return false;\n      }\n    } else if (row[columnIndex] === undefined || otherRow[columnIndex] === undefined) {\n      foundFieldToMatch = true;\n    }\n  }\n  return foundFieldToMatch;\n}\n\nexport function mergeTablesIntoModel(dst?: TableModel, ...tables: TableModel[]): TableModel {\n  const model = dst || new TableModel();\n\n  if (arguments.length === 1) {\n    return model;\n  }\n  // Single query returns data columns and rows as is\n  if (arguments.length === 2) {\n    model.columns = tables[0].hasOwnProperty('columns') ? [...tables[0].columns] : [];\n    model.rows = tables[0].hasOwnProperty('rows') ? [...tables[0].rows] : [];\n    return model;\n  }\n\n  // Track column indexes of union: name -> index\n  const columnNames = {};\n\n  // Union of all non-value columns\n  const columnsUnion = tables.slice().reduce((acc, series) => {\n    series.columns.forEach((col: any) => {\n      const { text } = col;\n      if (columnNames[text] === undefined) {\n        columnNames[text] = acc.length;\n        acc.push(col);\n      }\n    });\n    return acc;\n  }, [] as any[]);\n\n  // Map old column index to union index per series, e.g.,\n  // given columnNames {A: 0, B: 1} and\n  // data [{columns: [{ text: 'A' }]}, {columns: [{ text: 'B' }]}] => [[0], [1]]\n  const columnIndexMapper = tables.map(series => series.columns.map(col => columnNames[col.text]));\n\n  // Flatten rows of all series and adjust new column indexes\n  const flattenedRows = tables.reduce((acc, series, seriesIndex) => {\n    const mapper = columnIndexMapper[seriesIndex];\n    series.rows.forEach(row => {\n      const alteredRow: any[] = [];\n      // Shifting entries according to index mapper\n      mapper.forEach((to, from) => {\n        alteredRow[to] = row[from];\n      });\n      acc.push(alteredRow);\n    });\n    return acc;\n  }, [] as any[]);\n\n  // Merge rows that have same values for columns\n  const mergedRows = {};\n  const compactedRows = flattenedRows.reduce((acc, row, rowIndex) => {\n    if (!mergedRows[rowIndex]) {\n      // Look from current row onwards\n      let offset = rowIndex + 1;\n      // More than one row can be merged into current row\n      while (offset < flattenedRows.length) {\n        // Find next row that could be merged\n        const match = _.findIndex(flattenedRows, otherRow => areRowsMatching(columnsUnion, row, otherRow), offset);\n        if (match > -1) {\n          const matchedRow = flattenedRows[match];\n          // Merge values from match into current row if there is a gap in the current row\n          for (let columnIndex = 0; columnIndex < columnsUnion.length; columnIndex++) {\n            if (row[columnIndex] === undefined && matchedRow[columnIndex] !== undefined) {\n              row[columnIndex] = matchedRow[columnIndex];\n            }\n          }\n          // Don't visit this row again\n          mergedRows[match] = matchedRow;\n          // Keep looking for more rows to merge\n          offset = match + 1;\n        } else {\n          // No match found, stop looking\n          break;\n        }\n      }\n      acc.push(row);\n    }\n    return acc;\n  }, []);\n\n  model.columns = columnsUnion;\n  model.rows = compactedRows;\n  return model;\n}\n\ntransformers['timeseries_to_rows'] = {\n  description: 'Time series to rows',\n  getColumns: () => {\n    return [];\n  },\n  transform: (data, panel, model) => {\n    model.columns = [{ text: 'Time', type: 'date' }, { text: 'Metric' }, { text: 'Value' }];\n\n    for (let i = 0; i < data.length; i++) {\n      const series = data[i];\n      for (let y = 0; y < series.datapoints.length; y++) {\n        const dp = series.datapoints[y];\n        model.rows.push([dp[1], series.target, dp[0]]);\n      }\n    }\n  },\n};\n\ntransformers['timeseries_to_columns'] = {\n  description: 'Time series to columns',\n  getColumns: () => {\n    return [];\n  },\n  transform: (data, panel, model) => {\n    model.columns.push({ text: 'Time', type: 'date' });\n\n    // group by time\n    const points = {};\n\n    for (let i = 0; i < data.length; i++) {\n      const series = data[i];\n      model.columns.push({ text: series.target });\n\n      for (let y = 0; y < series.datapoints.length; y++) {\n        const dp = series.datapoints[y];\n        const timeKey = dp[1].toString();\n\n        if (!points[timeKey]) {\n          points[timeKey] = { time: dp[1] };\n          points[timeKey][i] = dp[0];\n        } else {\n          points[timeKey][i] = dp[0];\n        }\n      }\n    }\n\n    for (const time in points) {\n      const point = points[time];\n      const values = [point.time];\n\n      for (let i = 0; i < data.length; i++) {\n        const value = point[i];\n        values.push(value);\n      }\n\n      model.rows.push(values);\n    }\n  },\n};\n\ntransformers['timeseries_aggregations'] = {\n  description: 'Time series aggregations',\n  getColumns: () => {\n    return [\n      { text: 'Avg', value: 'avg' },\n      { text: 'Min', value: 'min' },\n      { text: 'Max', value: 'max' },\n      { text: 'Total', value: 'total' },\n      { text: 'Current', value: 'current' },\n      { text: 'Count', value: 'count' },\n    ];\n  },\n  transform: (data, panel, model) => {\n    let i, y;\n    model.columns.push({ text: 'Metric' });\n\n    for (i = 0; i < panel.columns.length; i++) {\n      model.columns.push({ text: panel.columns[i].text });\n    }\n\n    for (i = 0; i < data.length; i++) {\n      const series = new TimeSeries({\n        datapoints: data[i].datapoints,\n        alias: data[i].target,\n      });\n\n      series.getFlotPairs('connected');\n      const cells = [series.alias];\n\n      for (y = 0; y < panel.columns.length; y++) {\n        cells.push(series.stats[panel.columns[y].value]);\n      }\n\n      model.rows.push(cells);\n    }\n  },\n};\n\ntransformers['annotations'] = {\n  description: 'Annotations',\n  getColumns: () => {\n    return [];\n  },\n  transform: (data, panel, model) => {\n    model.columns.push({ text: 'Time', type: 'date' });\n    model.columns.push({ text: 'Title' });\n    model.columns.push({ text: 'Text' });\n    model.columns.push({ text: 'Tags' });\n\n    if (!data || !data.annotations || data.annotations.length === 0) {\n      return;\n    }\n\n    for (let i = 0; i < data.annotations.length; i++) {\n      const evt = data.annotations[i];\n      model.rows.push([evt.time, evt.title, evt.text, evt.tags]);\n    }\n  },\n};\n\ntransformers['table'] = {\n  description: 'Table',\n  getColumns: data => {\n    if (!data || data.length === 0) {\n      return [];\n    }\n\n    // Single query returns data columns as is\n    if (data.length === 1) {\n      return [...data[0].columns];\n    }\n\n    // Track column indexes: name -> index\n    const columnNames = {};\n\n    // Union of all columns\n    const columns = data.reduce((acc, series) => {\n      series.columns.forEach(col => {\n        const { text } = col;\n        if (columnNames[text] === undefined) {\n          columnNames[text] = acc.length;\n          acc.push(col);\n        }\n      });\n      return acc;\n    }, []);\n\n    return columns;\n  },\n  transform: (data, panel, model) => {\n    if (!data || data.length === 0) {\n      return;\n    }\n\n    const noTableIndex = _.findIndex(data, (d: any) => d.type !== 'table');\n    if (noTableIndex > -1) {\n      throw {\n        message: `Result of query #${String.fromCharCode(\n          65 + noTableIndex\n        )} is not in table format, try using another transform.`,\n      };\n    }\n\n    mergeTablesIntoModel(model, ...data);\n  },\n};\n\ntransformers['json'] = {\n  description: 'JSON Data',\n  getColumns: data => {\n    if (!data || data.length === 0) {\n      return [];\n    }\n\n    const names: any = {};\n    for (let i = 0; i < data.length; i++) {\n      const series = data[i];\n      if (series.type !== 'docs') {\n        continue;\n      }\n\n      // only look at 100 docs\n      const maxDocs = Math.min(series.datapoints.length, 100);\n      for (let y = 0; y < maxDocs; y++) {\n        const doc = series.datapoints[y];\n        const flattened = flatten(doc, null);\n        for (const propName in flattened) {\n          names[propName] = true;\n        }\n      }\n    }\n\n    return _.map(names, (value, key) => {\n      return { text: key, value: key };\n    });\n  },\n  transform: (data, panel, model) => {\n    let i, y, z;\n\n    for (const column of panel.columns) {\n      const tableCol: any = { text: column.text };\n\n      // if filterable data then set columns to filterable\n      if (data.length > 0 && data[0].filterable) {\n        tableCol.filterable = true;\n      }\n\n      model.columns.push(tableCol);\n    }\n\n    if (model.columns.length === 0) {\n      model.columns.push({ text: 'JSON' });\n    }\n\n    for (i = 0; i < data.length; i++) {\n      const series = data[i];\n\n      for (y = 0; y < series.datapoints.length; y++) {\n        const dp = series.datapoints[y];\n        const values: any[] = [];\n\n        if (_.isObject(dp) && panel.columns.length > 0) {\n          const flattened = flatten(dp, null);\n          for (z = 0; z < panel.columns.length; z++) {\n            values.push(flattened[panel.columns[z].value]);\n          }\n        } else {\n          values.push(JSON.stringify(dp));\n        }\n\n        model.rows.push(values);\n      }\n    }\n  },\n};\n\nfunction transformDataToTable(data, panel) {\n  const model = new TableModel();\n\n  if (!data || data.length === 0) {\n    return model;\n  }\n\n  const transformer = transformers[panel.transform];\n  if (!transformer) {\n    throw { message: 'Transformer ' + panel.transform + ' not found' };\n  }\n\n  transformer.transform(data, panel, model);\n  return model;\n}\n\nexport { transformers, transformDataToTable };\n","module.exports = __WEBPACK_EXTERNAL_MODULE__grafana_ui__;","module.exports = __WEBPACK_EXTERNAL_MODULE_grafana_app_core_config__;","module.exports = __WEBPACK_EXTERNAL_MODULE_grafana_app_core_table_model__;","module.exports = __WEBPACK_EXTERNAL_MODULE_grafana_app_core_time_series2__;","module.exports = __WEBPACK_EXTERNAL_MODULE_grafana_app_core_utils_flatten__;","module.exports = __WEBPACK_EXTERNAL_MODULE_grafana_app_core_utils_kbn__;","module.exports = __WEBPACK_EXTERNAL_MODULE_grafana_app_plugins_sdk__;","module.exports = __WEBPACK_EXTERNAL_MODULE_jquery__;","module.exports = __WEBPACK_EXTERNAL_MODULE_lodash__;","module.exports = __WEBPACK_EXTERNAL_MODULE_moment__;"],"sourceRoot":""}